---
phase: 38-tutorial
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [docs/tutorial.md]
autonomous: true
requirements: [TUT-01, TUT-02]

must_haves:
  truths:
    - docs/tutorial.md contains Step 12 covering lambda_url YAML configuration
    - docs/tutorial.md contains Step 13 covering rsf deploy for Lambda URL provisioning
    - docs/tutorial.md contains Step 14 with a copy-pasteable curl POST command
    - The new steps follow the existing tutorial's numbered step pattern and MkDocs admonition syntax
  artifacts:
    - docs/tutorial.md (extended with Steps 12-14)
  key_links:
    - Step 12 references the lambda_url DSL field with enabled and auth_type
    - Step 13 references rsf deploy and Terraform provisioning
    - Step 14 references curl POST with a placeholder Lambda URL endpoint
---

<objective>
Extend the existing tutorial with Lambda Function URL steps

Purpose: Users who completed the main tutorial (Steps 1-11) can continue with Steps 12-14 to add Lambda URL HTTP trigger capability, re-deploy, and invoke their workflow via curl POST. Satisfies TUT-01 and TUT-02.
Output: Updated docs/tutorial.md with three new steps appended after Step 11's "Next steps" section (which should be renumbered/repositioned after the new steps).
</objective>

<execution_context>
@/home/esa/.claude/get-shit-done/workflows/execute-plan.md
@/home/esa/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@docs/tutorial.md
@examples/lambda-url-trigger/workflow.yaml
@examples/lambda-url-trigger/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Steps 12-14 to docs/tutorial.md</name>
  <files>docs/tutorial.md</files>
  <action>
Append three new steps to docs/tutorial.md BEFORE the existing "## Next steps" section (move "Next steps" to remain at the end). Follow the exact conventions used in Steps 1-11: `## Step N: Action` headings, language-annotated code blocks, MkDocs admonitions.

**Step 12: Add a Lambda Function URL trigger**

Explain that users can add an HTTP trigger to their existing workflow so it can be invoked via HTTP POST instead of (or in addition to) the AWS CLI. Show the YAML change: add the `lambda_url` block at the top level of `workflow.yaml`:

```yaml
lambda_url:
  enabled: true
  auth_type: NONE
```

Include a brief explanation that `auth_type: NONE` creates a public endpoint (no authentication required). Add a `!!! tip` admonition mentioning that `AWS_IAM` auth is available for production use, requiring SigV4 signed requests — refer users to the DSL reference for details.

Optionally show running `rsf validate` to confirm the configuration is accepted (follow the existing Step 4 pattern).

**Step 13: Re-deploy with Lambda URL**

Show running `rsf deploy` again. Explain that Terraform will detect the new `lambda_url` configuration and provision an `aws_lambda_function_url` resource. After `terraform apply` completes, the output will include the Lambda Function URL endpoint. Show example output:

```
Outputs:

function_url = "https://<url-id>.lambda-url.<region>.on.aws/"
```

Add a `!!! note` admonition explaining that the URL is generated by AWS and will be unique to their deployment.

**Step 14: Invoke via HTTP POST**

Show a curl command to POST a JSON payload to the Lambda Function URL. Use a placeholder URL that matches the output format:

```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"order": {"id": "ORD-042", "items": [{"name": "Gadget", "price": 49.99, "qty": 1}]}}' \
  "https://<url-id>.lambda-url.<region>.on.aws/"
```

Explain that this triggers a durable execution just like invoking via the AWS CLI (Step 9), but accessible over HTTP. The Lambda Function URL receives the POST body as the event payload.

Add a `!!! tip` admonition mentioning they can use `rsf inspect` (Step 10) to observe the execution triggered by the HTTP POST.

At the end, add a brief cross-reference: "See the complete [Lambda URL Trigger example](https://github.com/your-org/rsf-python/tree/main/examples/lambda-url-trigger) for a standalone project with tests."

**After the new steps, keep the existing "## Next steps" section** — it should remain the final section of the tutorial. No changes to its content.
  </action>
  <verify>
    <automated>grep -c "## Step 12\|## Step 13\|## Step 14" docs/tutorial.md | grep -q "3" && echo "PASS: All 3 new steps found" || echo "FAIL: Missing steps"</automated>
  </verify>
  <done>docs/tutorial.md contains Steps 12, 13, and 14 in the correct order, before the "Next steps" section, following existing tutorial conventions</done>
</task>

<task type="auto">
  <name>Task 2: Verify tutorial content quality</name>
  <files>docs/tutorial.md</files>
  <action>
Verify the updated tutorial by checking:

1. The lambda_url YAML block appears in Step 12 with `enabled: true` and `auth_type: NONE`
2. Step 13 mentions `rsf deploy` and shows Terraform output with `function_url`
3. Step 14 contains a complete curl command with `-X POST`, `-H "Content-Type: application/json"`, a `-d` payload, and a placeholder Lambda URL
4. MkDocs admonitions use the correct syntax (`!!! tip`, `!!! note`, `!!! warning`)
5. The "## Next steps" section remains at the end of the file
6. No broken markdown (unclosed code fences, mismatched headers)
7. Step numbering is sequential (12, 13, 14) and follows after the existing Step 11

Run `grep` checks to verify each element is present. If any content is missing or incorrect, fix it in docs/tutorial.md.
  </action>
  <verify>
    <automated>grep -q "lambda_url:" docs/tutorial.md && grep -q "auth_type: NONE" docs/tutorial.md && grep -q "curl" docs/tutorial.md && grep -q "rsf deploy" docs/tutorial.md && grep -q "## Next steps" docs/tutorial.md && echo "PASS: All content verified" || echo "FAIL: Missing content"</automated>
  </verify>
  <done>Tutorial contains all required elements: lambda_url YAML config, rsf deploy instructions, curl POST command, correct admonitions, and Next steps section at end</done>
</task>

</tasks>

<verification>
- [ ] `grep "## Step 12" docs/tutorial.md` finds the lambda_url configuration step
- [ ] `grep "## Step 13" docs/tutorial.md` finds the deployment step
- [ ] `grep "## Step 14" docs/tutorial.md` finds the curl invocation step
- [ ] `grep "lambda_url:" docs/tutorial.md` finds the YAML configuration block
- [ ] `grep "curl" docs/tutorial.md` finds the POST command
- [ ] `grep "auth_type: NONE" docs/tutorial.md` confirms NONE auth type is shown
- [ ] `grep "AWS_IAM" docs/tutorial.md` confirms IAM auth is mentioned as an alternative
- [ ] `grep "## Next steps" docs/tutorial.md` confirms the section still exists at the end
- [ ] The file renders correctly as markdown (no broken fences or malformed admonitions)
</verification>

<success_criteria>
- TUT-01: Tutorial covers lambda_url configuration in workflow YAML and Terraform deployment (Steps 12-13)
- TUT-02: Tutorial demonstrates invoking durable execution via curl POST to Lambda URL (Step 14)
- Tutorial follows existing conventions (numbered steps, code blocks, admonitions)
- "Next steps" section remains at end of tutorial
</success_criteria>

<output>
After completion, create `.planning/phases/38-tutorial/38-01-SUMMARY.md`
</output>
